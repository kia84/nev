Changelog
=========

## Use Autoprefixer - 21.06.2014

* Используем гем [Autoprefixer](https://github.com/postcss/autoprefixer).

## rank_name helper - 02.01.2015
* Добавлен хелпер `rank_name`, выводящий span-тег для названия ранга пользователя.
  Используется пока только на странице пользователя и сообщениях на форуме.

## SHA-1 digest for assets and `female` helper - 29.12.2014
* К ссылкам подключения стилей и скриптов теперь прибавляется восьмизначный хэш,
  чтобы избежать проблем с кэшированными файлами при обновлении.<br>
  Чтобы собрать архив с правильными ссылками нужно перед этим скомпилировать
  стили и скрипты.
* Добавлен хэлпер `female`, призванный улучшить читабельность кода и уменьшить
  количество магических чисел.

  ```ruby
  female
  # => "$USER_GENDER_ID$=2"
  female('$_GENDER_ID$')
  # => "$_GENDER_ID$=2"
  ```

## rake ftp:test ftp:load_assets - 14.12.2014
* Добавлена rake-задача для проверки FTP соединения (`ftp:test`).
* И ещё одна, для удобной загрузки css и js файлов (`ftp:load_assets`).

## RSTARS helper - 19.09.2014
* Добавлен хелпер `rating_stars`.<br>
  Он используется для вывода и настройки кода `$RSTARS$`.

## rake ftp:load_archive - 16.09.2014
* Добавлена rake-задача для автоматической загрузки архива с шаблонами на сервер.<br>
  Реквизиты FTP доступа настраиваются в конфиге: `config/ftp.yml`.

## rake vendor_update - 09.09.2014
* Добавлена rake-задача для автоматического обновления vendor-файлов.<br>
  Список этих файлов настраивается в конфиге: `config/vendor_files.yml`.

## Specify custom string for condition statements - 03.09.2014
* Теперь `UcozConditionStatement` можно использовать для рендера в строку.<br>
  Может быть полезно при объявлении переменных ([пример](https://github.com/korun/nev/blob/3bd15febf18aa7182ce8f0a1ef985ad95ef5d1cd/templates/dir/index_category.html.erb#L4-L10)).

## Remove obsolete VK comments - 02.09.2014
* Комментарии через ВКонтакте API больше не нужны.<br>
  http://blog.ucoz.ru/blog/2014-06-16-329

## Remove admin bar - 01.09.2014
* Добавлен хелпер `remove_admin_bar!`.<br>
  Он используется в шаблонах, где `$ADMIN_BAR$` не должен быть показан.<br>
  Это bang-метод, поэтому его результат можно не выводить (т.е. использовать
  `<%  %>` вместо `<%=  %>`).

## Deprecated codes - 30.08.2014
* Добавлен файл `config/deprecated_codes.yml`, куда будут добавляться коды,
  которые нежелательно использовать.<br>
  Использование таких кодов провоцирует warn-лог, в котором написано что лучше
  использовать взамен.

## Page generation - 20.08.2014
* Добавлена задача для генерации страниц (конечный HTML).
  Пока поддерживается только подстановка кодов, в планах
  условные операторы и инъекции.

## Application config - 04.08.2014
* Добавлен config файл для приложения: `/config/application.rb`<br>
  Пока там только один параметр, `home_url`, но в дальнейшем будут
  появляться ещё.

## Rendering partials - 11.07.2014
* Добавлен хелпер `render` для вставки повторяющегося кода из партиалов.

## Improved support for ucoz codes - 09.07.2014
* Добавлен хелпер `ucoz_code` (`c`) для вставки юкоз-кодов в шаблоны.
* Добавлен хелпер `ucoz_injection` (`i`) для инъекций серверных вызовов.
* Добавлена поддержка однострочных условных операторов (`inline_if[not]`).

## RSpec - 03.07.2014
* Да здравствуют тесты!

## Use Uglifier - 21.06.2014

* Используем гем [uglifier](https://github.com/lautis/uglifier), для минификации JS.

## Condition statements - 19.06.2014

* Добавлен специальный класс для юкозовских условных операторов.
* Для использования этого класса объявлены хелперы `ucoz_if` и `ucoz_ifnot`.<br>
  Теперь:
  * условия записываются в виде erb-инъекций (IDE теперь не будет ругаться):

    ```erb
    <% ucoz_if(group_is('$GROUP_ID$', :admin)) { %>
        admin code
    <% }.else { %>
        dummy code
    <% }.endif! %>
    ```
  * для блока с условием определены простейшие валидации,
    как то невозможность указать несколько `else` или `endif`;
  * если в шаблоне обнаружены незакрытые `if` (`ifnot`) теги,
    произойдёт ошибка, и шаблон не соберётся.

## Helpers - 14.06.2014

* Добавлена папка для хелперов, теперь их будет много.
* Добавлено два хелпера для условных операторов: `code_is` и `group_is`.

## SASS - 23.05.2014

* Используем [SASS](http://sass-lang.com/) для стилей!

## VK helpers - 18.05.2014

* Добавлен хелпер `vk_like_btn`.
  Так как имеется возможность поделиться понравившимся материалом
  с помощью этой кнопки, кнопку _share_ выпилил.
* Добавлен хелпер для генерации блока ВКомментариев:
  `vk_comments_box`. Имеет один аргумент - `UID`.

## Redirect with meta tag - 08.05.2014

Добавлен хелпер `home_url`.

Также добавлен хелпер для перенаправления, для использования нужно указать:
```ruby
@params[:redirect][:path] = '/dir/6'
```

Тогда в layout автоматически добавится следующее:
```html
<meta http-equiv="refresh" content="0; url=#{@params[:redirect][:path]}">
<script type="text/javascript">location.replace("#{home_url}#{@params[:redirect][:path]}");</script>
```

## ERB and layouts - 26.04.2014

Поддержка ERB, использование хелперов, а также _layouts_ в шаблонах (во
избежание дублирования кода).

## Rake tasks and Sprockets - 31.03.2014

Добавлены `rake` задачи для:

* генерации архива с шаблонами;
* генерации assets-файлов.

## `$GLOBAL_AJAXJS$` - 09.02.2014

* Добавлен новый глобальный блок: `$GLOBAL_AJAXJS$`.
Он содержит в себе стандартные подключаемые (css, js) файлы.
При сохранении система прячет код `$AJAX_JS$`, следует учитывать это при
необходимости редактирования шаблона.

## Fractions and `prompt-link` - 24.01.2014

* Для указания пользовательской фракции использовать класс `fraction-name$_MSN$`,
для отображения знамени:

  ```html
<span class="fraction-flag fflag$_MSN$"></span>
  ```
  А для вывода текстового описания ранга:
  ```html
<span class="rank-$_RANK$-$_MSN$ <?if($_GENDER_ID$='2')?>rank-$_RANK$-$_MSN$-f<?endif?>"></span>
  ```
* Для всех prompt-ссылок добавлен единый класс `prompt-link`, который
активирует нужный js-скрипт.
Для его использования нужно заполнить аттрибуты `title` и `href`.

## First refactoring - 11.01.2014

* Переход на блочную верстку.
* Вынесение части кода в подключаемые css и js файлы.
* Срараемся соблюдать идеалогию "ненавязчивого" javascript.
* Вместо `$PROFILE_URL$`, генерирующего ужас:

  ```html
<a href="javascript://" rel="nofollow"
   onclick="window.open('http://site.ru/index/8-1',
       'up1','scrollbars=1,top=0,left=0,resizable=1,width=680,height=350');
       return false;">Tester</a>
  ```
  используется класс `profile-link` и любая валидная ссылка на профиль
  (`/index/8-$USER_ID$` или `/index/8-0-$USERNAME$`) в атрибуте `href`.
